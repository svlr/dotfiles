##########################################
#              Backend & Core           #
##########################################

backend = "glx";
#vsync = true;
use-damage = false;  # гарантирует обновление окон без багов
log-level = "warn";

detect-client-opacity = false;  # КРИТИЧНО — запрещаем клиентам вроде rofi управлять прозрачностью
detect-rounded-corners = true;
detect-transient = true;

mark-wmwin-focused = true;
mark-ovredir-focused = true;

transparent-clipping = false;

##########################################
#             Opacity & Dimming         #
##########################################

active-opacity = 1.0;
inactive-opacity = 0.88;
inactive-opacity-override = true;

inactive-dim = 0.08;
inactive-dim-fixed = true;

frame-opacity = 1.0;

opacity-rule = [
  "100:class_g = 'Rofi'",  # ← делает rofi непрозрачным, на всякий случай
  "100:class_g = 'Polybar'",
  "100:window_type *= 'menu'"
];

##########################################
#                Corners                #
##########################################

corner-radius = 12;
rounded-corners = true;
round-borders = true;

rounded-corners-exclude = [
  "window_type = 'dock'",
  "window_type = 'desktop'",
  "class_g = 'Polybar'",
  "class_g = 'i3-frame'",
  "name *= 'popup'",
  "window_type *= 'menu'",
  "window_type = 'dialog'",
  "class_g = 'Dunst'"
];

##########################################
#                Shadows                #
##########################################

shadow = true;
shadow-radius = 12;
shadow-offset-x = -8;
shadow-offset-y = -8;
shadow-opacity = 0.35;

shadow-exclude = [
  "class_g = 'systray'",
  "name = 'Notification'",
  "class_g = 'Polybar'",
  "window_type = 'dock'",
  "window_type = 'desktop'",
  "bounding_shaped = true"
];

##########################################
#                Fading                 #
##########################################

fading = false;
no-fading-openclose = true;

##########################################
#              Animations               #
##########################################

animations = false;

animation-for-open-window = "none";
animation-for-unmap-window = "none";
animation-for-transient-window = "none";
animation-for-workspace-switch-in  = "none";
animation-for-workspace-switch-out = "none";

animation-exclude = [];

##########################################
#              Wintypes                 #
##########################################

wintypes : {
  tooltip : {
    fade = false;
    shadow = false;
    opacity = 1.0;
  };
  dock : {
    shadow = false;
    blur-background = false;
    corner-radius = 0;
  };
  dnd : {
    shadow = false;
  };
  popup_menu : {
    opacity = 1.0;
  };
  dropdown_menu : {
    opacity = 1.0;
  };
};
